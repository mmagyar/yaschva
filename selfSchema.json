{
  "$schema": "./schema.json",
  "$types": {
    "$customType": { "$keyOf": ["$types"] },
    "$customTypeDef": {
      "\\$types": [
        "?",
        {
          "key": {
            "$string": {
              "regex": "^\\$([a-zA-Z0-9_]{1,128})$"
            }
          },
          "$map": "$valueTypes"
        }
      ]
    },
    "$optionalPositiveInteger": [
      "?",
      {
        "$number": {
          "min": 0,
          "integer": true
        }
      }
    ],
    "$simpleTypes": {
      "$enum": ["string", "boolean", "number", "integer", "null", "?", "any"]
    },
    "$enumType": {
      "name": ["?", "string"],
      "description": ["?", "string"],
      "\\$enum": {
        "minLength": 1,
        "$array": "string"
      }
    },
    "$objectType": {
      "key": {
        "$string": {
          "regex": "(^(?!\\$).*)|(\\$enum|\\$array|\\$type|\\$string|\\$number|\\$types|\\$and|\\$literal|\\$keyOf)"
        }
      },
      "$map": "$valueTypes"
    },
    "$arrayType": {
      "name": ["?", "string"],
      "description": ["?", "string"],
      "minLength": "$optionalPositiveInteger",
      "maxLength": "$optionalPositiveInteger",
      "\\$array": "$valueTypes"
    },
    "$stringType": {
      "\\$string": [
        {
          "minLength": "$optionalPositiveInteger",
          "maxLength": "$optionalPositiveInteger"
        },
        {
          "regex": ["?", "string"]
        }
      ]
    },
    "$numberType": {
      "\\$number": {
        "min": ["?", "number"],
        "max": ["?", "number"],
        "integer": ["?", "boolean"]
      }
    },
    "$metaType": {
      "name": ["?", "string"],
      "description": ["?", "string"],
      "\\$type": "$valueTypes"
    },
    "$mapType": {
      "minLength": "$optionalPositiveInteger",
      "maxLength": "$optionalPositiveInteger",
      "key": ["?", "$stringType", "$enumType", "$keyOfType", "$customType"],
      "keySpecificType": [
        "?",
        {
          "$map": "$valueTypes"
        },
        "$customType"
      ],
      "\\$map": "$valueTypes"
    },
    "$keyOfType": {
      "\\$keyOf": [
        {
          "minLength": 0,
          "maxLength": 0,
          "$array": "?"
        },
        {
          "minLength": 1,
          "maxLength": 1,
          "$array": { "$keyOf": [] }
        },
        {
          "minLength": 2,
          "$array": "string"
        }
      ]
    },
    "$literalType": {
      "\\$literal": ["string", "number", "null"]
    },
    "$andType": {
      "\\$and": {
        "$array": ["$objectType", "$customType"]
      }
    },
    "$valueType": [
      "$simpleTypes",
      "$enumType",
      "$objectType",
      "$arrayType",
      "$stringType",
      "$numberType",
      "$metaType",
      "$mapType",
      "$keyOfType",
      "$literalType",
      "$andType",
      "$customType"
    ],
    "$valueTypes": [
      {
        "minLength": 1,
        "$array": "$valueType"
      },
      "$valueType"
    ],
    "$validation": [
      "$simpleTypes",
      "$enumType",
      {
        "$map": "$valueTypes",
        "key": {
          "$string": {
            "regex": "(^(?!\\$).*)|(\\$types)"
          }
        },
        "keySpecificType": "$customTypeDef"
      },
      {
        "$and": ["$customTypeDef", "$arrayType"]
      },
      {
        "$and": ["$customTypeDef", "$stringType"]
      },
      {
        "$and": ["$customTypeDef", "$numberType"]
      },
      {
        "$and": ["$customTypeDef", "$metaType"]
      },
      {
        "$and": ["$customTypeDef", "$mapType"]
      },
      {
        "$and": ["$customTypeDef", "$andType"]
      },
      {
        "minLength": 1,
        "$array": "$valueType"
      }
    ]
  },
  "$type": "$validation"
}
